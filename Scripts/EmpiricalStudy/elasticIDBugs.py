# python script to extract all the id of the bugs in Elastic Search
# Imports
import sys
import webbrowser
import requests
import subprocess
import shlex
import json
import re
import random
from BeautifulSoup import BeautifulSoup

##variables
arrayIdBugs= []

## To extract all the ID from the issues we will scrap the html response.
# urlGithub = "https://github.com/elastic/elasticsearch/issues?utf8=%E2%9C%93&q=is%3Aissue+is%3Aclosed+label%3Abug"
# response=requests.get(urlGithub)
# html = response.content
# soup = BeautifulSoup(html)

# # We can not do more than 975 request to Github, so we have to split in two different queries. 1-39--> for i in range(1, 39), 40-74 --> for i in range(40, 74)
# for i in range(40, 74):
# 	if i == 1:
# 		urlGithub = "https://github.com/elastic/elasticsearch/issues?utf8=%E2%9C%93&q=is%3Aissue+is%3Aclosed+label%3Abug"
# 	else:
# 		urlGithub = "https://github.com/elastic/elasticsearch/issues?page="+str(i)+"&q=is%3Aissue+is%3Aclosed+label%3Abug&utf8=%E2%9C%93"
	
# 	response=requests.get(urlGithub)
# 	html = response.content
# 	soup = BeautifulSoup(html)
	
	##All the issues has the 'li' label and its id start by the word 'issue_'
# 	for li in soup.findAll('li', id=re.compile('^issue_')):
# 		issuenumber= li.get('id')
# 		idBug = issuenumber.split('issue_')
# 		arrayIdBugs.append(idBug[1])

## We print the array with all of id Bugs and save them into the variable array arrayIDBugs.
# print arrayIdBugs

# After scrap the html page and save all the id bugs in the array arrayIdBugs with all the bugs until Jun 24 2016
arrayIdBugs =['19034', '18974', '18961', '18946', '18944', '18929', '18912', '18885', '18803', '18794', '18740', '18707', '18640', '18623', '18618', '18588', '18584', '18546', '18476', '18458', '18450', '18444', '18439', '18436', '18398', '18388', '18353', '18336', '18326', '18325', '18299', '18293', '18256', '18249', '18202', '18164', '18163', '18162', '18158', '18144', '18139', '18135', '18134', '18126', '18091', '18089', '18085', '18062', '18054', '18017', '18010', '17971', '17953', '17929', '17905', '17885', '17866', '17854', '17823', '17819', '17783', '17707', '17705', '17701', '17683', '17644', '17625', '17581', '17567', '17537', '17535', '17533', '17529', '17518', '17516', '17495', '17484', '17483', '17470', '17460', '17435', '17430', '17395', '17362', '17302', '17296', '17294', '17257', '17241', '17226', '17225', '17212', '17140', '17126', '17119', '17101', '17097', '17084', '17053', '17025', '17011', '16925', '16906', '16890', '16887', '16815', '16812', '16790', '16734', '16717', '16716', '16711', '16709', '16692', '16689', '16645', '16624', '16594', '16583', '16579', '16577', '16550', '16549', '16547', '16546', '16544', '16536', '16525', '16519', '16485', '16484', '16481', '16419', '16408', '16391', '16376', '16321', '16253', '16246', '16239', '16219', '16218', '16206', '16194', '16169', '16139', '16137', '16135', '16129', '16109', '16105', '16086', '16073', '16058', '16032', '15997', '15994', '15988', '15974', '15949', '15941', '15935', '15921', '15908', '15893', '15860', '15858', '15822', '15790', '15789', '15782', '15774', '15757', '15756', '15754', '15706', '15701', '15690', '15689', '15657', '15648', '15623', '15590', '15582', '15568', '15562', '15553', '15537', '15521', '15471', '15450', '15431', '15430', '15422', '15413', '15381', '15370', '15349', '15340', '15338', '15333', '15307', '15306', '15291', '15284', '15269', '15257', '15241', '15225', '15194', '15190', '15183', '15179', '15148', '15146', '15138', '15135', '15129', '15120', '15096', '15081', '15062', '15061', '15057', '15049', '15043', '15005', '14963', '14960', '14957', '14946', '14944', '14932', '14908', '14882', '14862', '14843', '14837', '14828', '14804', '14798', '14796', '14782', '14746', '14735', '14730', '14706', '14685', '14684', '14670', '14628', '14625', '14584', '14573', '14527', '14475', '14445', '14383', '14357', '14346', '14328', '14319', '14290', '14287', '14273', '14262', '14205', '14194', '14163', '14115', '14109', '14102', '14090', '14083', '14057', '14025', '14023', '14012', '14010', '13986', '13949', '13935', '13887', '13884', '13872', '13858', '13855', '13812', '13811', '13810', '13795', '13776', '13773', '13740', '13685', '13676', '13665', '13662', '13658', '13616', '13527', '13492', '13472', '13449', '13401', '13392', '13386', '13379', '13345', '13340', '13337', '13336', '13335', '13334', '13332', '13327', '13326', '13320', '13319', '13316', '13315', '13297', '13278', '13277', '13274', '13265', '13264', '13259', '13249', '13247', '13242', '13230', '13213', '13210', '13196', '13179', '13169', '13132', '13129', '13112', '13107', '13094', '13088', '13079', '13064', '13040', '13028', '13017', '12993', '12988', '12945', '12915', '12914', '12907', '12906', '12891', '12889', '12874', '12873', '12865', '12842', '12840', '12839', '12804', '12791', '12790', '12753', '12730', '12714', '12701', '12700', '12689', '12683', '12682', '12677', '12666', '12649', '12643', '12580', '12573', '12572', '12563', '12557', '12550', '12531', '12523', '12519', '12510', '12504', '12479', '12467', '12456', '12439', '12433', '12422', '12391', '12389', '12382', '12360', '12345', '12340', '12333', '12332', '12327', '12322', '12311', '12292', '12278', '12268', '12266', '12245', '12212', '12207', '12193', '12192', '12185', '12170', '12143', '12142', '12118', '12116', '12086', '12066', '12056', '12034', '12011', '12005', '12000', '11994', '11947', '11924', '11922', '11882', '11876', '11870', '11858', '11857', '11831', '11809', '11771', '11760', '11730', '11721', '11710', '11699', '11692', '11672', '11665', '11631', '11612', '11599', '11594', '11573', '11572', '11564', '11513', '11506', '11487', '11476', '11474', '11458', '11457', '11454', '11429', '11400', '11388', '11379', '11376', '11370', '11369', '11360', '11335', '11314', '11281', '11277', '11271', '11249', '11246', '11237', '11226', '11208', '11170', '11150', '11136', '11130', '11129', '11122', '11119', '11118', '11085', '11055', '11025', '11019', '10995', '10992', '10987', '10979', '10978', '10926', '10836', '10810', '10807', '10804', '10764', '10742', '10728', '10719', '10693', '10671', '10661', '10660', '10651', '10629', '10614', '10609', '10591', '10590', '10581', '10574', '10549', '10546', '10521', '10517', '10513', '10500', '10487', '10477', '10456', '10447', '10407', '10402', '10397', '10361', '10357', '10351', '10338', '10334', '10318', '10308', '10290', '10284', '10265', '10262', '10253', '10244', '10164', '10158', '10135', '10133', '10113', '10109', '10060', '10056', '10053', '10025', '10011', '10007', '9979', '9961', '9958', '9956', '9945', '9931', '9924', '9922', '9907', '9904', '9878', '9862', '9860', '9849', '9821', '9816', '9814', '9769', '9766', '9730', '9723', '9715', '9691', '9655', '9638', '9634', '9617', '9615', '9596', '9576', '9566', '9547', '9540', '9534', '9511', '9491', '9462', '9447', '9424', '9421', '9386', '9360', '9323', '9317', '9309', '9305', '9294', '9281', '9280', '9271', '9266', '9260', '9249', '9248', '9225', '9223', '9216', '9204', '9174', '9144', '9140', '9136', '9107', '9087', '9081', '9080', '9065', '9050', '9045', '9024', '9023', '9013', '8999', '8958', '8940', '8937', '8903', '8893', '8890', '8887', '8886', '8846', '8837', '8830', '8828', '8810', '8800', '8792', '8788', '8748', '8706', '8672', '8652', '8650', '8636', '8629', '8617', '8615', '8595', '8587', '8580', '8564', '8538', '8526', '8512', '8507', '8490', '8485', '8483', '8474', '8471', '8438', '8433', '8432', '8431', '8424', '8423', '8419', '8416', '8396', '8377', '8365', '8364', '8339', '8333', '8308', '8301', '8280', '8278', '8268', '8267', '8254', '8249', '8239', '8227', '8226', '8224', '8209', '8140', '8132', '8125', '8120', '8117', '8107', '8102', '8090', '8085', '8078', '8073', '8071', '8064', '8046', '8040', '8036', '8031', '8001', '7985', '7980', '7967', '7962', '7951', '7926', '7917', '7916', '7915', '7904', '7893', '7886', '7875', '7863', '7840', '7838', '7816', '7803', '7791', '7779', '7740', '7713', '7697', '7689', '7686', '7673', '7651', '7644', '7640', '7635', '7629', '7625', '7623', '7615', '7572', '7567', '7566', '7560', '7559', '7556', '7553', '7536', '7505', '7495', '7487', '7478', '7455', '7450', '7437', '7433', '7430', '7429', '7423', '7408', '7404', '7390', '7386', '7373', '7368', '7364', '7357', '7356', '7352', '7349', '7343', '7317', '7315', '7312', '7311', '7306', '7304', '7301', '7299', '7295', '7273', '7270', '7266', '7260', '7258', '7240', '7237', '7226', '7215', '7153', '7152', '7148', '7142', '7131', '7126', '7125', '7121', '7115', '7114', '7106', '7087', '7086', '7080', '7050', '7038', '7019', '7016', '7004', '6994', '6962', '6958', '6939', '6932', '6900', '6897', '6894', '6893', '6887', '6871', '6828', '6827', '6808', '6745', '6722', '6713', '6694', '6676', '6671', '6655', '6644', '6642', '6632', '6630', '6600', '6598', '6587', '6552', '6546', '6540', '6506', '6496', '6473', '6442', '6424', '6411', '6410', '6399', '6392', '6383', '6377', '6363', '6357', '6355', '6340', '6318', '6314', '6304', '6297', '6296', '6292', '6281', '6279', '6278', '6268', '6260', '6255', '6239', '6237', '6234', '6215', '6213', '6192', '6181', '6179', '6174', '6172', '6158', '6147', '6116', '6113', '6112', '6111', '6110', '6061', '6037', '6025', '6018', '6008', '6005', '5997', '5982', '5976', '5974', '5972', '5958', '5956', '5948', '5945', '5930', '5919', '5906', '5864', '5855', '5848', '5844', '5825', '5794', '5790', '5783', '5779', '5778', '5773', '5772', '5766', '5743', '5730', '5729', '5726', '5715', '5705', '5703', '5680', '5667', '5657', '5646', '5643', '5622', '5615', '5592', '5586', '5582', '5578', '5576', '5559', '5556', '5551', '5532', '5531', '5525', '5514', '5505', '5493', '5480', '5477', '5474', '5473', '5454', '5437', '5414', '5408', '5399', '5390', '5389', '5363', '5328', '5326', '5316', '5292', '5290', '5258', '5256', '5246', '5242', '5236', '5229', '5221', '5220', '5212','5210', '5195', '5190', '5185', '5179', '5177', '5175', '5165', '5155', '5142', '5129', '5127', '5104', '5057', '5053', '5049', '5048', '5038', '5030', '5021', '5020', '5017', '5009', '5004', '4987', '4977', '4970', '4964', '4960', '4951', '4947', '4945', '4941', '4927', '4924', '4914', '4903', '4902', '4901', '4900', '4892', '4887', '4885', '4881', '4867', '4864', '4852', '4849', '4848', '4843', '4835', '4833', '4827', '4814', '4805', '4788', '4785', '4782', '4775', '4771', '4761', '4760', '4757', '4745', '4718', '4703', '4701', '4692', '4685', '4679', '4674', '4670', '4668', '4657', '4644', '4643', '4636', '4630', '4610', '4589', '4582', '4581', '4579', '4576', '4572', '4568', '4564', '4563', '4560', '4544', '4534', '4529', '4528', '4526', '4519', '4511', '4508', '4502', '4457', '4451', '4440', '4426', '4423', '4417', '4415', '4411', '4410', '4390', '4361', '4356', '4351', '4348', '4341', '4334', '4330', '4325', '4320', '4315', '4313', '4306', '4303', '4298', '4296', '4291', '4273', '4270', '4239', '4237', '4235', '4232', '4223', '4203', '4198', '4196', '4186', '4166', '4153', '4147', '4135', '4127', '4124', '4116', '4113', '4112', '4106', '4103', '4100', '4094', '4093', '4089', '4073', '4047', '4045', '4028', '4009', '3989', '3981', '3979', '3965', '3955', '3952', '3949', '3931', '3929', '3928', '3906', '3901', '3898', '3892', '3884', '3882', '3881', '3878', '3873', '3872', '3850', '3849', '3848', '3847', '3840', '3838', '3820', '3808', '3797', '3793', '3785', '3783', '3778', '3769', '3760', '3758', '3754', '3747', '3746', '3739', '3725', '3717', '3712', '3707', '3706', '3703', '3697', '3691', '3677', '3669', '3667', '3661', '3652', '3634', '3629', '3626', '3625', '3619', '3617', '3610', '3601', '3591', '3587', '3585', '3580', '3560', '3559', '3555', '3551', '3544', '3540', '3538', '3526', '3521', '3517', '3515', '3513', '3508', '3507', '3503', '3489', '3487', '3486', '3479', '3478', '3477', '3476', '3474', '3471', '3470', '3469', '3464', '3463', '3453', '3452', '3448', '3447', '3444', '3427', '3425', '3419', '3402', '3396', '3374', '3364', '3363', '3359', '3356', '3354', '3342', '3317', '3313', '3310', '3309', '3290', '3288', '3284', '3276', '3274', '3267', '3262', '3257', '3253', '3252', '3247', '3246', '3245', '3242', '3237', '3232', '3229', '3224', '3211', '3204', '3200', '3196', '3189', '3177', '3174', '3168', '3161', '3144', '3142', '3140', '3139', '3111', '3109', '3091', '3088', '3078', '3073', '3068', '3063', '3055', '3051', '3039', '3037', '3024', '3017', '3012', '3008', '3007', '3006', '3000', '2994', '2991', '2986', '2984', '2979', '2975', '2973', '2971', '2970', '2953', '2952', '2944', '2937', '2931', '2920', '2918', '2914', '2896', '2886', '2882', '2878', '2873', '2868', '2861', '2851', '2848', '2837', '2833', '2829', '2826', '2820', '2817', '2816', '2814', '2812', '2808', '2807', '2806', '2801', '2785', '2773', '2766', '2762', '2752', '2750', '2746', '2745', '2744', '2733', '2731', '2730', '2729', '2724', '2716', '2711', '2705', '2701', '2696', '2695', '2694', '2693', '2692', '2690', '2682', '2675', '2665', '2658', '2651', '2649', '2643', '2642', '2641', '2629', '2626', '2624', '2612', '2609', '2608', '2599', '2596', '2594', '2592', '2572', '2566', '2546', '2544', '2543', '2542', '2537', '2536', '2530', '2518', '2515', '2501', '2500', '2498', '2495', '2489', '2488', '2487', '2486', '2470', '2461', '2451', '2449', '2441', '2432', '2428', '2423', '2416', '2408', '2404', '2402', '2401', '2397', '2395', '2394', '2380', '2371', '2363', '2352', '2345', '2340', '2332', '2329', '2317', '2302', '2300', '2297', '2296', '2285', '2283', '2275', '2253', '2242', '2241', '2206', '2205', '2197', '2192', '2183', '2155', '2141', '2117', '2085', '2077', '2076', '2075', '2072', '2071', '2065', '2062', '2055', '2053', '2051', '2046', '2042', '2017', '2006', '1982', '1976', '1967', '1965', '1964', '1960', '1948', '1947', '1939', '1926', '1925', '1921', '1912', '1905', '1901', '1896', '1894', '1892', '1887', '1877', '1875', '1866', '1865', '1853', '1852', '1845', '1839', '1834', '1833', '1828', '1819', '1818', '1816', '1814', '1807', '1804', '1794', '1793', '1774', '1773', '1772', '1770', '1754', '1751', '1749', '1740', '1738', '1727', '1725', '1724', '1709', '1706', '1705', '1704', '1702', '1686', '1664', '1663', '1651', '1647', '1632', '1626', '1623', '1617', '1615', '1608', '1592', '1591', '1586', '1582', '1580', '1575', '1569', '1564', '1547', '1546', '1543', '1537', '1536', '1524', '1517', '1516', '1511', '1505', '1497', '1487', '1485', '1484', '1474', '1471', '1470', '1468', '1467', '1458', '1457', '1455', '1450', '1436', '1431', '1429', '1419', '1418', '1403', '1401', '1400', '1397', '1392', '1390', '1389', '1382', '1380', '1370', '1369', '1359', '1355', '1354', '1344', '1337', '1325', '1324', '1323', '1321', '1320', '1314', '1297', '1296', '1294', '1280', '1260', '1257', '1249', '1244', '1238', '1237', '1234', '1232', '1229', '1227', '1226', '1225', '1222', '1208', '1199', '1198', '1193', '1192', '1191', '1190', '1180', '1168', '1167', '1162', '1159', '1156', '1154', '1153', '1152', '1150', '1149', '1147', '1145', '1143', '1141', '1138', '1135', '1134', '1133', '1131', '1130', '1127', '1122', '1118', '1103', '1094', '1085', '1081', '1072', '1070', '1062', '1047', '1039', '1038', '1033', '1032', '1020', '1016', '1002', '996', '990', '977', '953', '950', '946', '938', '937', '934', '932', '931', '929', '923', '903', '902', '899', '892', '888', '886', '883', '878', '875', '873', '869', '864', '862', '859', '858', '853', '850', '845', '839', '837', '835', '833', '832', '831', '829', '824', '823', '800', '790', '781', '764', '763', '743', '736', '732', '728', '727', '725', '720', '714', '711', '702', '695', '681', '665', '659', '658', '641', '637', '633', '629', '617', '615', '614', '613', '600', '581', '580', '579', '578', '577', '575', '568', '560', '559', '555', '532', '531', '527', '521', '494', '484', '479', '477', '466', '465', '452', '451', '430', '414', '409', '391', '386', '375', '369', '366', '363', '362', '341', '332', '329', '328', '327', '326', '324', '318', '300', '299', '297', '295', '285', '284', '283', '280', '274', '270', '262', '261', '252', '247', '240', '236', '224', '209', '201', '200', '178', '175', '170', '168', '153', '148', '136', '123', '119', '104', '93', '83', '76', '73', '68', '62', '60', '59', '57', '55', '52', '40', '39', '38', '32', '31', '29', '28', '27', '25', '24', '19']

totalBugs= len(arrayIdBugs)

# These are the variables to claculate the number of Bugs that are statistically significant
Z = 1.96
p = 0.5
e = 0.05 
samplenum = totalBugs*(Z*Z)*p*(1-p)
sampledenom = ((totalBugs-1)*(e*e))+((Z*Z)*p*(1-p))
sample = int(round(samplenum/sampledenom))

# we take from the arrayIdBugs a random sample of the idbugs.
randomsample = random.sample(arrayIdBugs,sample)

print ('My list of random sample is: ', randomsample)
print len(randomsample)
